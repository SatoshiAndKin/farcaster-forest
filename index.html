<!DOCTYPE html>
<html lang="en">

<head>
    <base href="https://satoshiandkin.github.io/farcaster-forest/" />

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Farcaster Forest</title>

    
    
    
    <link rel="icon" href="https://satoshiandkin.github.io/farcaster-forest/icon-2c7b45e122a9d340.ico" integrity="sha384-UKQuv6Q1dj+0vZ0+BHk3ixAZ9cNiplC5i9TZXUdAroQNZ39TBFAPoo87Ex4W1bfX"/>
    <style>body, html {
    height: 100%;
}

body {
    background-color: lightgray;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
}

.game-container {
    width: 100vw;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.lds-dual-ring {
    display: inline-block;
    position: absolute;
    left: 0;
    right: 0;
    margin: auto;
    width: 80px;
    height: 80px;
}

.lds-dual-ring:after {
    content: " ";
    display: block;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: 6px solid #fff;
    border-color: #fff transparent #fff transparent;
    animation: lds-dual-ring 1.2s linear infinite;
}

@keyframes lds-dual-ring {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

#bevy {
    z-index: 2;
}
</style>

<link rel="modulepreload" href="https://satoshiandkin.github.io/farcaster-forest/bevy_game-18561a96e0e97de2.js" crossorigin="anonymous" integrity="sha384-VEsEIZAWxjFjSEq3i75pb6Eqq1/mZRK8T8jEkqsWkNxh3EIjZt/UnRhc6BxI+KWm"><link rel="preload" href="https://satoshiandkin.github.io/farcaster-forest/bevy_game-18561a96e0e97de2_bg.wasm" crossorigin="anonymous" integrity="sha384-ZNgLE1hE9jzHEjHqzAlY2IivgRgEIMQQcruGw/oslZlsaK9W+UCJ2Y0rufuFo3iu" as="fetch" type="application/wasm"></head>

<body>
    <script>// Hack to resume AudioContexts on first user interaction.
// https://developers.google.com/web/updates/2018/11/web-audio-autoplay#moving-forward
// Uses capture phase so events fire before Bevy's canvas handlers can stop propagation.
// Includes touchstart for iOS Safari reliability.
(function () {
    const audioContextList = [];

    const userInputEventNames = [
        "click",
        "contextmenu",
        "auxclick",
        "dblclick",
        "mousedown",
        "mouseup",
        "pointerdown",
        "pointerup",
        "touchstart",
        "touchend",
        "keydown",
        "keyup",
    ];

    function proxyContext(original) {
        if (!original) return;
        return new Proxy(original, {
            construct(target, args) {
                const result = new target(...args);
                audioContextList.push(result);
                return result;
            },
        });
    }

    self.AudioContext = proxyContext(self.AudioContext);
    if (self.webkitAudioContext) {
        self.webkitAudioContext = proxyContext(self.webkitAudioContext);
    }

    function resumeAllContexts(_event) {
        let count = 0;

        audioContextList.forEach((context) => {
            if (context.state !== "running") {
                context.resume();
            } else {
                count++;
            }
        });

        if (count > 0 && count === audioContextList.length) {
            userInputEventNames.forEach((eventName) => {
                document.removeEventListener(eventName, resumeAllContexts, true);
            });
        }
    }

    userInputEventNames.forEach((eventName) => {
        document.addEventListener(eventName, resumeAllContexts, true);
    });
})();
</script>
    <div class="game-container">
        <div class="lds-dual-ring"></div>
        <canvas id="bevy">
            Javascript and support for canvas is required
        </canvas>
    </div>

    <script type="module">
        import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk'
        import { Client } from 'https://esm.sh/@xmtp/browser-sdk'

        const isMiniApp = await sdk.isInMiniApp()

        if (isMiniApp) {
            console.log("in a mini-app")

            // TODO: do this **after** your app is fully loaded and ready to display
            await sdk.actions.ready()
        } else {
            console.log("not in a mini-app")
        }
    </script>

<script type="module">
import init, * as bindings from 'https://satoshiandkin.github.io/farcaster-forest/bevy_game-18561a96e0e97de2.js';
const wasm = await init({ module_or_path: 'https://satoshiandkin.github.io/farcaster-forest/bevy_game-18561a96e0e97de2_bg.wasm' });


window.wasmBindings = bindings;


dispatchEvent(new CustomEvent("TrunkApplicationStarted", {detail: {wasm}}));

</script></body>

</html>